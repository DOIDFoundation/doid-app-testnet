System.register(["./index-legacy.394d7721.js","./vendor-legacy.25bbea8c.js"],(function(t,e){"use strict";var s,i,r,n,o,a,d,l,u,p,h,c,g,m,y,w,f,v,b,x,S,$,k,O,j,q,D,A,I,P,C,B;return{setters:[t=>{s=t.a,i=t.b,r=t.u,n=t.c,o=t.n,a=t.e,d=t._,l=t.d,u=t.f,p=t.h,h=t.i,c=t.j,g=t.k,m=t.l,y=t.w,w=t.m,f=t.g,v=t.T},t=>{b=t.p,x=t.S,S=t.x,$=t.B,k=t.z,O=t.A,j=t.y,q=t.j,D=t.k,A=t.m,I=t.e,P=t.c,C=t.D,B=t.n}],execute:function(){const L=t("g",(async()=>s("Resolver")));var N=Object.defineProperty,E=Object.getOwnPropertyDescriptor;class R extends x{constructor(t){super(),this.key="",this.key=t}save(){this.queue=[...this.queue],localStorage.setItem(this.key,JSON.stringify(this.queue))}}((t,e,s,i)=>{for(var r,n=i>1?void 0:i?E(e,s):e,o=t.length-1;o>=0;o--)(r=t[o])&&(n=(i?r(e,s,n):r(n))||n);i&&n&&N(e,s,n)})([b({value:[]})],R.prototype,"queue",2);class z{constructor(t){this.provider=r().bridgeStore.bridge.provider,this.store=new R(`evm.txs.${t||this.provider.account}`),this.checking=new Set,this.check(!0)}get queue(){return this.store.queue}async add(t){if(!t.chainId){const{network:e}=this.provider;t.chainId=e.chainId,t.scan=e.scan}t.pending=!0,this.queue.unshift(t),this.store.save(),this.provider.nonce=+t.nonce+1}delDelay(t,e=0){setTimeout((()=>this.del(t)),e)}del(t){const e=t.hash??t.ts??t;this.queue.some(((t,s)=>{if([t.hash,t.ts,t].includes(e)){0===s&&(this.provider.nonce=0);const t=this.queue.splice(s,1);return this.store.save(),t}}))}async check(t){this.queue.forEach((async(e,s)=>{if(t&&0===s){const t=await n(this.provider.account),s=+e.nonce;this.provider.nonce=s>t?s+1:t}if(e.done||(new Date).getTime()-e.ts>=72e5)return this.del(e);if(!e.err&&(t||!e.pending)){e.pending=!0;try{const t=await this.provider.waitForTransaction(e.hash),{status:s}=t;e.status=s,1===s?(e.done=!0,this.del(e)):e.err=!0}catch(i){e.err=i}e.pending=!1}})),this.store.save()}}const F={},T=(t=i.bridge.account)=>F[t]||(F[t]=new z(t));class M{constructor(t,{errorCodes:e="",seq:s,delay:i=0,allowAlmostSuccess:r=!1,onSent:n=(()=>{}),onSuccess:o=(()=>{}),onError:a=(()=>{})}={}){this.pending=!0,this.status=-1,this.allowAlmostSuccess=r,this.txPromise=t,this.err=void 0,this.hash="",this.errorCodes=e,this.seq=s,this.delay=i,this.onSent=n,this.onSuccess=o,this.onError=a}get success(){return 1===this.status}get processing(){return 2===this.status}get almostSuccess(){return 4===this.status}get ignored(){return 3===this.status}async wait(t=!1){return(async()=>{let s=!1;const i=await(async t=>t?"object"==typeof t?t:await d(Object.assign({"./abi/Locker.codes.json":()=>l((()=>e.import("./Locker.codes-legacy.d5ca7e1e.js")),void 0),"./abi/Resolver.codes.json":()=>l((()=>e.import("./Resolver.codes-legacy.77c566ca.js")),void 0)}),`./abi/${t}.codes.json`):{})(this.errorCodes);try{const e=await this.txPromise;this.onSent(e);const{hash:r,nonce:n}=e;this.seq.nonce=n,this.seq&&(delete this.seq.overrides,T().add(Object.assign(this.seq,{hash:r}))),this.hash=r,this.status=2;const o=async()=>{const{status:t,events:s}=await e.wait(1);if(1!==t)throw this.seq&&(this.seq.err=!0),new Error("Failed");s.some((({event:t,args:e}={})=>{if("Failure"===t){let{info:t,detail:s,error:r}=e;const n=r.toString(),o=i[r],a={code:n,message:o,error:r,info:t?.toString(),detail:s?.toString()};this.seq&&(this.seq.err=!0);const d=new Error(o);throw Object.assign(d,{code:n,raw:a}),this.allowAlmostSuccess&&(this.status=4),d}})),this.status=1,this.seq&&(this.seq.done=!0),this.delay?T().delDelay(r,this.delay):T().del(r)};t?(s=!0,o()):await o(),this.onSuccess(e)}catch(r){throw await o(r),4001===r.code?this.status=3:4!==this.status&&(this.status=0),this.err=r,this.onError(r),r}finally{this.pending=!1;const t=1===this.status;a.emit("tx-status",this.hash),t&&a.emit("tx-success",this.hash),s=t}return s})()}}t("t",M);const U=(t,e={})=>{const s={...t,...e},{owner:i,status:r,account:n}=s,o=!!n&&i.toLowerCase()===n.toLowerCase(),a="locked"===r,d="available"===r||o&&a,l="registered"===r;let u=a?"Locked by pass":d?"Available":"Unavailable";return l&&o&&(u="Registered"),{name:y(s.name),owner:i,available:d,registered:l,stat:u,status:r,itsme:o,id:S(s.id||0,0),locked:a}},V=t("n",(async(t,e)=>{const s=async t=>{e||(e=await u());const s=await L(),i={name:t=y(t),account:e};try{const e=await s.statusOfName(p(t));Object.assign(i,U(e,i))}catch{}return i};return Array.isArray(t)?await Promise.all(t.map(s)):await s(t)}));t("d",(async(t,e)=>{e||(e=await u());const s=await L(),i=[];try{const r=await s.namesOfOwner(t);i.push(...r.map((s=>U(s,{owner:t,account:e,status:"registered"}))))}catch{}return i})),t("o",(async t=>{if(!t)return;let e=p(t),s=await L();const i=await s.nameHash(e),r=await s.addrs(i),n=await h();return r.forEach((([t,e])=>{const s=S(t,0);n[s]&&(n[s].address=e)})),Object.values(n)})),t("a",(async(t,e,s)=>{let i=await L();const r=await c(),n=p(t),o=await r.getBlockNumber(),a=(await r.getBlock(o)).timestamp,d=$.from(k(32)),l=await i.makeAddrMessage(n,s,e,a,d);return{name:t,dest:e,timestamp:a,nonce:d._hex,message:l}})),t("b",(async t=>({signature:await(await g()).signMessage(t)}))),t("c",(async(t,e,s,i,r,n)=>{let o=await L();const a="setAddr",d={},l=[p(t),e,s,+i,r,n];await m(d,o,a,l);const u=o[a](...l);return new M(u,{errorCodes:"Resolver",allowAlmostSuccess:!0,seq:{type:"setAddr",title:`set Address ${s}`,ts:(new Date).getTime(),overrides:d}})}));var K=Object.defineProperty,_=Object.getOwnPropertyDescriptor,H=(t,e,s,i)=>{for(var r,n=i>1?void 0:i?_(e,s):e,o=t.length-1;o>=0;o--)(r=t[o])&&(n=(i?r(e,s,n):r(n))||n);return i&&n&&K(e,s,n),n};class J extends x{constructor(){super(...arguments),this.search=async t=>{this.pending=!0,this.names=[];const{address:e,name:s}=await w(t,{allowAddress:!0,wrap:!0});if(e)return f(`/address/${e}`);if(s){const t=await V([s]);this.names=[t[0]]}this.ts++,this.pending=!1}}get len(){return this.names.length}get empty(){return!this.pending&&!this.len}}H([b({value:!1})],J.prototype,"pending",2),H([b({value:[]})],J.prototype,"names",2),H([b({value:0})],J.prototype,"ts",2);const G=t("s",new J),Q=function(t={}){return this.validateDOIDName=async e=>{const s=e.detail;this.DOID={};const i=isNaN(this.nameMinLen)?t.len:this.nameMinLen,r=await w(s,{...t,len:i}),{name:n="",address:o="",error:a,msg:d}=r;if(a)return{error:a,msg:d};const l=t.allowAddress&&o,u=l?o:/\..+$/.test(s)?y(n):n;return(l||n&&!/[^.]\.{1}$/.test(s))&&(this.input$?this.input$.value.$("input").value=u:console.warn("Please use ref(this.input$) on inputElement first")),this.DOID=r,r}},W=(t,e={})=>class extends t{constructor(){super(...arguments),this.validateDOIDName=Q.bind(this,e)(),this.DOID={},this.input$=O()}};var X=Object.defineProperty,Y=Object.getOwnPropertyDescriptor,Z=(t,e,s,i)=>{for(var r,n=i>1?void 0:i?Y(e,s):e,o=t.length-1;o>=0;o--)(r=t[o])&&(n=(i?r(e,s,n):r(n))||n);return i&&n&&X(e,s,n),n};const tt=(t,e,{lower:s=!1,upper:i=!1}={})=>(t&&(t=t?.trim(),s?t=t.toLowerCase():i&&(t=t.toUpperCase())),t);let et=class extends(v('.dui-input-text{position:relative;margin-left:auto;margin-right:auto;display:flex;width:100%;padding-top:1.25rem;padding-bottom:1.25rem}.dui-input-text input[type]{font-family:var(--fontFamily);position:relative;display:inline-flex;height:2rem;width:100%;border-radius:.375rem;--tw-bg-opacity: 1;background-color:rgba(255,255,255,var(--tw-bg-opacity));padding:1.5rem .75rem;font-size:1rem;line-height:1.5rem;border:1px solid #ccc}.dui-input-text[disabled]{opacity:.6}.dui-input-text.sm{padding-top:0;padding-bottom:0}.dui-input-text.sm input[type]{height:1.5rem;padding-top:1rem;padding-bottom:1rem;font-size:.875rem;line-height:1.25rem}.dui-input-text.sm .dui-input-right,.dui-input-text.sm .dui-input-left{padding-top:1rem;padding-bottom:1rem;line-height:1rem}.dui-input-text .dui-input-msg,.dui-input-text .dui-input-tip,.dui-input-text label{line-height:1!important}.dui-input-text .dui-input-msg,.dui-input-text .dui-input-tip,.dui-input-text label{position:absolute;display:flex;height:1rem;flex-wrap:wrap;align-items:center;padding-left:.75rem;padding-right:.75rem;font-size:.875rem;line-height:1.25rem;margin-left:1px;top:.15rem}.dui-input-text .dui-input-msg{top:auto;bottom:.15rem}.dui-input-text .dui-input-tip{left:auto;right:0px}.dui-input-text .dui-input-right,.dui-input-text .dui-input-left{pointer-events:none;position:absolute;display:flex;height:1.5rem;align-items:center;justify-content:center;border-top-right-radius:.375rem;border-bottom-right-radius:.375rem;padding:1.5rem .5rem;min-width:1.5rem;z-index:1;right:1px;margin-top:1px;font-size:1em;line-height:1em}.dui-input-text .dui-input-right:empty,.dui-input-text .dui-input-left:empty{--tw-bg-opacity: 1;background-color:rgba(0,0,0,var(--tw-bg-opacity))}.dui-input-text .dui-input-right>*,.dui-input-text .dui-input-left>*{pointer-events:auto}.dui-input-text .dui-input-left{right:auto;left:1px}.dui-input-text[required] label:after{display:inline-flex;align-items:center;justify-content:center;vertical-align:middle;font-weight:600;line-height:1;--tw-text-opacity: 1;color:rgba(239,68,68,var(--tw-text-opacity));content:"*";height:1em;margin-left:.25em}.dui-input-text[rightSlotted] input[type]{padding-right:5rem}.dui-input-text.sm[rightSlotted] input[type]{padding-right:2.5rem}.dui-input-text[leftSlotted] input[type]{padding-left:2.75rem}.dui-input-text.sm[leftSlotted] input[type]{padding-left:2rem}\n')){constructor(){super(...arguments),this.placeholder="",this.type="text",this.class="",this.sm=!1,this.disabled=!1,this.autoforce=!1,this.required=!1,this.lower=!1,this.upper=!1,this.err=!1,this.value="",this.debounce=300,this.rightSlotted=!1,this.leftSlotted=!1,this.onKeyup=t=>{"Enter"===t.key&&(this.emit("submit",this.value),setTimeout((()=>this.updateVal())))}}onSlotChange(t){const e=t.target;e&&e.assignedNodes({flatten:!0}).length}onSlotRight(t){this.rightSlotted=!!t.target}onSlotLeft(t){this.leftSlotted=!!t.target}firstUpdated(){if(this.autoforce){const t=this.$("input");t.focus(),t.select()}}onFocus(t){t.target.select()}updateVal(){const t=this.$("input");t&&(t.value=this.value)}onInput(t){t.stopImmediatePropagation();let e=t.target.value;this.value=tt(e,0,{lower:this.lower,upper:this.upper})||"",this.updateVal(),this.emit("input",e)}render(){return j`<div class="dui-input-text ${q(this.$c([this.class,{sm:this.sm}]))}" ?required="${this.required}" ?rightSlotted="${this.rightSlotted}" ?leftSlotted="${this.leftSlotted}" part="dui-input-text"><label><slot name="label" @slotchange="${this.onSlotChange}"></slot></label> <span class="dui-input-left"><slot name="left" @slotchange="${this.onSlotLeft}"></slot></span><input .type="${this.type}" .disabled="${this.disabled}" placeholder="${this.placeholder}" value="${this.value}" title="${this.title}" @focus="${this.onFocus}" @input="${this.onInput}" @keyup="${this.onKeyup}"><div class="dui-input-right"><slot name="right" @slotchange="${this.onSlotRight}"></slot></div><div class="dui-input-msg"><slot name="msg" @slotchange="${this.onSlotChange}"></slot></div><div class="dui-input-tip"><slot name="tip" @slotchange="${this.onSlotChange}"></slot></div></div>`}};Z([A({type:String})],et.prototype,"placeholder",2),Z([A({type:String})],et.prototype,"type",2),Z([A({type:String})],et.prototype,"class",2),Z([A({type:Boolean})],et.prototype,"sm",2),Z([A({type:Boolean})],et.prototype,"disabled",2),Z([A({type:Boolean})],et.prototype,"autoforce",2),Z([A({type:Boolean})],et.prototype,"required",2),Z([A({type:Boolean})],et.prototype,"lower",2),Z([A({type:Boolean})],et.prototype,"upper",2),Z([A({type:Boolean})],et.prototype,"err",2),Z([A({type:String,converter:tt})],et.prototype,"value",2),Z([A({type:Number})],et.prototype,"debounce",2),Z([D()],et.prototype,"rightSlotted",2),Z([D()],et.prototype,"leftSlotted",2),et=Z([I("dui-input-text")],et);var st=Object.defineProperty,it=Object.getOwnPropertyDescriptor,rt=(t,e,s,i)=>{for(var r,n=i>1?void 0:i?it(e,s):e,o=t.length-1;o>=0;o--)(r=t[o])&&(n=(i?r(e,s,n):r(n))||n);return i&&n&&st(e,s,n),n};let nt=class extends(W(v(""),{allowAddress:!0})){constructor(){super(...arguments),this.bindStore=new P(this,G),this.bindBridge=new P(this,i),this.placeholder="Search names or addresses",this.entire=!1,this.keyword="",this.err="",this.pending=!1,this.onInput=async t=>{const{val:e,error:s,msg:i}=await this.validateDOIDName(t);this.err=i,s||(this.keyword=e)}}doSearch(){if(!i.bridge.account)return a.emit("connect-wallet");this.err||(this.DOID.name&&(this.keyword=y(this.keyword)),this.emit("search",this.keyword))}async connectedCallback(){if(super.connectedCallback(),void 0===this.default)return;const{name:t="",address:e=""}=await w(this.default,{allowAddress:!0,wrap:!0});this.keyword=t||e}render(){return j`<dui-input-text ${C(this.input$)} @input="${this.onInput}" @submit="${this.doSearch}" value="${this.keyword}" placeholder="${this.placeholder}" ?disabled="${this.pending}"><span slot="label"><slot name="label"></slot></span><span slot="right" class="-mr-1"><dui-button @click="${this.doSearch}" icon sm class="text-blue-500"><i class="mdi mdi-magnify text-lg"></i></dui-button></span><span slot="msg">${B(this.err,(()=>j`<span class="text-red-500">${this.err}</span>`),(()=>j`<slot name="msg"></slot>`))}</span></dui-input-text>`}};rt([A()],nt.prototype,"placeholder",2),rt([A()],nt.prototype,"default",2),rt([A({type:Boolean})],nt.prototype,"entire",2),rt([D()],nt.prototype,"keyword",2),rt([D()],nt.prototype,"err",2),rt([D()],nt.prototype,"pending",2),nt=rt([I("dui-ns-search")],nt);var ot=Object.defineProperty,at=Object.getOwnPropertyDescriptor,dt=(t,e,s,i)=>{for(var r,n=i>1?void 0:i?at(e,s):e,o=t.length-1;o>=0;o--)(r=t[o])&&(n=(i?r(e,s,n):r(n))||n);return i&&n&&ot(e,s,n),n};let lt=class extends(v("")){constructor(){super(...arguments),this.icon=""}render(){return j`<strong class="block w-24 h-24 m-12 mx-auto" href="/"><img class="w-full h-full object-contain select-none pointer-events-none" src="${this.icon||"/assets/doid-15c8a698.svg"}"></strong><div class="my-8 text-center"><strong class="block"><slot name="h1"></slot></strong><slot name="msg"></slot></div>`}};dt([A()],lt.prototype,"icon",2),lt=dt([I("doid-symbol")],lt)}}}));
